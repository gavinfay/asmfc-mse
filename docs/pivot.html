<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Pivot Tables with dplyr | R for Excel Users</title>
  <meta name="description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Pivot Tables with dplyr | R for Excel Users" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Pivot Tables with dplyr | R for Excel Users" />
  
  <meta name="twitter:description" content="This is a workshop for RStudio::conf(2020) in San Francisco, California" />
  

<meta name="author" content="Julie Lowndes &amp; Allison Horst" />


<meta name="date" content="2020-01-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ggplot2.html"/>
<link rel="next" href="tidying.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Excel Users</a></li>
<li><a href="https://github.com/rstudio-conf-2020/r-for-excel/">← Go to GitHub repo</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#agenda"><i class="fa fa-check"></i><b>1.1</b> Agenda</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#data-citations"><i class="fa fa-check"></i><b>1.3</b> Data citations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2</b> Overview</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html#welcome-1"><i class="fa fa-check"></i><b>2.1</b> Welcome!</a><ul>
<li class="chapter" data-level="2.1.1" data-path="overview.html"><a href="overview.html#you-are-all-welcome-here"><i class="fa fa-check"></i><b>2.1.1</b> You are all welcome here</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="overview.html"><a href="overview.html#guiding-principles-recurring-themes"><i class="fa fa-check"></i><b>2.2</b> Guiding principles / recurring themes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>3</b> R &amp; RStudio, RMarkdown</a><ul>
<li class="chapter" data-level="3.1" data-path="rstudio.html"><a href="rstudio.html#summary"><i class="fa fa-check"></i><b>3.1</b> Summary</a><ul>
<li class="chapter" data-level="3.1.1" data-path="rstudio.html"><a href="rstudio.html#objectives"><i class="fa fa-check"></i><b>3.1.1</b> Objectives</a></li>
<li class="chapter" data-level="3.1.2" data-path="rstudio.html"><a href="rstudio.html#resources"><i class="fa fa-check"></i><b>3.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="rstudio.html"><a href="rstudio.html#rstudio-orientation"><i class="fa fa-check"></i><b>3.2</b> RStudio Orientation</a></li>
<li class="chapter" data-level="3.3" data-path="rstudio.html"><a href="rstudio.html#intro-to-rmarkdown"><i class="fa fa-check"></i><b>3.3</b> Intro to RMarkdown</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rstudio.html"><a href="rstudio.html#create-an-rmarkdown-file"><i class="fa fa-check"></i><b>3.3.1</b> Create an RMarkdown file</a></li>
<li class="chapter" data-level="3.3.2" data-path="rstudio.html"><a href="rstudio.html#knit-your-rmarkdown-file"><i class="fa fa-check"></i><b>3.3.2</b> Knit your RMarkdown file</a></li>
<li class="chapter" data-level="3.3.3" data-path="rstudio.html"><a href="rstudio.html#markdown-text"><i class="fa fa-check"></i><b>3.3.3</b> Markdown text</a></li>
<li class="chapter" data-level="3.3.4" data-path="rstudio.html"><a href="rstudio.html#r-code"><i class="fa fa-check"></i><b>3.3.4</b> R code</a></li>
<li class="chapter" data-level="3.3.5" data-path="rstudio.html"><a href="rstudio.html#code-chunks"><i class="fa fa-check"></i><b>3.3.5</b> Code chunks</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rstudio.html"><a href="rstudio.html#r-code-in-the-console"><i class="fa fa-check"></i><b>3.4</b> R code in the Console</a><ul>
<li class="chapter" data-level="3.4.1" data-path="rstudio.html"><a href="rstudio.html#error-messages"><i class="fa fa-check"></i><b>3.4.1</b> Error messages</a></li>
<li class="chapter" data-level="3.4.2" data-path="rstudio.html"><a href="rstudio.html#running-rmarkdown-code-chunks"><i class="fa fa-check"></i><b>3.4.2</b> Running RMarkdown code chunks</a></li>
<li class="chapter" data-level="3.4.3" data-path="rstudio.html"><a href="rstudio.html#writing-code-in-a-file-vs.console"><i class="fa fa-check"></i><b>3.4.3</b> Writing code in a file vs. Console</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rstudio.html"><a href="rstudio.html#r-functions"><i class="fa fa-check"></i><b>3.5</b> R functions</a></li>
<li class="chapter" data-level="3.6" data-path="rstudio.html"><a href="rstudio.html#help-pages"><i class="fa fa-check"></i><b>3.6</b> Help pages</a></li>
<li class="chapter" data-level="3.7" data-path="rstudio.html"><a href="rstudio.html#commenting"><i class="fa fa-check"></i><b>3.7</b> Commenting</a></li>
<li class="chapter" data-level="3.8" data-path="rstudio.html"><a href="rstudio.html#assigning-objects-with--"><i class="fa fa-check"></i><b>3.8</b> Assigning objects with <code>&lt;-</code></a></li>
<li class="chapter" data-level="3.9" data-path="rstudio.html"><a href="rstudio.html#r-packages"><i class="fa fa-check"></i><b>3.9</b> R Packages</a><ul>
<li class="chapter" data-level="3.9.1" data-path="rstudio.html"><a href="rstudio.html#how-do-you-know-what-packagesfunctions-exist"><i class="fa fa-check"></i><b>3.9.1</b> How do you know what packages/functions exist?</a></li>
<li class="chapter" data-level="3.9.2" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages"><i class="fa fa-check"></i><b>3.9.2</b> Installing R Packages</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="rstudio.html"><a href="rstudio.html#github-brief-intro-config"><i class="fa fa-check"></i><b>3.10</b> GitHub brief intro &amp; config</a><ul>
<li class="chapter" data-level="3.10.1" data-path="rstudio.html"><a href="rstudio.html#configure-github"><i class="fa fa-check"></i><b>3.10.1</b> Configure GitHub</a></li>
<li class="chapter" data-level="3.10.2" data-path="rstudio.html"><a href="rstudio.html#ensure-that-gitgithubrstudio-are-communicating"><i class="fa fa-check"></i><b>3.10.2</b> Ensure that Git/GitHub/RStudio are communicating</a></li>
<li class="chapter" data-level="3.10.3" data-path="rstudio.html"><a href="rstudio.html#troubleshooting"><i class="fa fa-check"></i><b>3.10.3</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.10.4" data-path="rstudio.html"><a href="rstudio.html#end-rstudiormarkdown-session"><i class="fa fa-check"></i><b>3.10.4</b> END <strong>RStudio/RMarkdown</strong> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="github.html"><a href="github.html"><i class="fa fa-check"></i><b>4</b> GitHub</a><ul>
<li class="chapter" data-level="4.1" data-path="github.html"><a href="github.html#summary-1"><i class="fa fa-check"></i><b>4.1</b> Summary</a><ul>
<li class="chapter" data-level="4.1.1" data-path="github.html"><a href="github.html#objectives-1"><i class="fa fa-check"></i><b>4.1.1</b> Objectives</a></li>
<li class="chapter" data-level="4.1.2" data-path="github.html"><a href="github.html#resources-1"><i class="fa fa-check"></i><b>4.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="github.html"><a href="github.html#why-should-r-users-use-github"><i class="fa fa-check"></i><b>4.2</b> Why should R users use Github?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="github.html"><a href="github.html#what-is-github-and-git"><i class="fa fa-check"></i><b>4.2.1</b> What is Github? And Git?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="github.html"><a href="github.html#create-a-repository-on-github.com"><i class="fa fa-check"></i><b>4.3</b> Create a repository on Github.com</a></li>
<li class="chapter" data-level="4.4" data-path="github.html"><a href="github.html#clone-your-repository-using-rstudio"><i class="fa fa-check"></i><b>4.4</b> Clone your repository using RStudio</a><ul>
<li class="chapter" data-level="4.4.1" data-path="github.html"><a href="github.html#copy-the-repo-address"><i class="fa fa-check"></i><b>4.4.1</b> Copy the repo address</a></li>
<li class="chapter" data-level="4.4.2" data-path="github.html"><a href="github.html#rstudio-new-project-1"><i class="fa fa-check"></i><b>4.4.2</b> RStudio: New Project</a></li>
<li class="chapter" data-level="4.4.3" data-path="github.html"><a href="github.html#select-version-control-1"><i class="fa fa-check"></i><b>4.4.3</b> Select Version Control</a></li>
<li class="chapter" data-level="4.4.4" data-path="github.html"><a href="github.html#select-git-1"><i class="fa fa-check"></i><b>4.4.4</b> Select Git</a></li>
<li class="chapter" data-level="4.4.5" data-path="github.html"><a href="github.html#paste-the-repo-address"><i class="fa fa-check"></i><b>4.4.5</b> Paste the repo address</a></li>
<li class="chapter" data-level="4.4.6" data-path="github.html"><a href="github.html#admire-your-local-repo"><i class="fa fa-check"></i><b>4.4.6</b> Admire your local repo</a></li>
<li class="chapter" data-level="4.4.7" data-path="github.html"><a href="github.html#inspect-your-local-repo"><i class="fa fa-check"></i><b>4.4.7</b> Inspect your local repo</a></li>
<li class="chapter" data-level="4.4.8" data-path="github.html"><a href="github.html#edit-your-readme-file"><i class="fa fa-check"></i><b>4.4.8</b> Edit your README file</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="github.html"><a href="github.html#sync-from-rstudio-local-to-github-remote"><i class="fa fa-check"></i><b>4.5</b> Sync from RStudio (local) to GitHub (remote)</a><ul>
<li class="chapter" data-level="4.5.1" data-path="github.html"><a href="github.html#pull"><i class="fa fa-check"></i><b>4.5.1</b> Pull</a></li>
<li class="chapter" data-level="4.5.2" data-path="github.html"><a href="github.html#stage"><i class="fa fa-check"></i><b>4.5.2</b> Stage</a></li>
<li class="chapter" data-level="4.5.3" data-path="github.html"><a href="github.html#commit"><i class="fa fa-check"></i><b>4.5.3</b> Commit</a></li>
<li class="chapter" data-level="4.5.4" data-path="github.html"><a href="github.html#push"><i class="fa fa-check"></i><b>4.5.4</b> Push</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="github.html"><a href="github.html#commit-history"><i class="fa fa-check"></i><b>4.6</b> Commit history</a></li>
<li class="chapter" data-level="4.7" data-path="github.html"><a href="github.html#project-oriented-workflows"><i class="fa fa-check"></i><b>4.7</b> Project-oriented workflows</a><ul>
<li class="chapter" data-level="4.7.1" data-path="github.html"><a href="github.html#working-directory"><i class="fa fa-check"></i><b>4.7.1</b> Working directory</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="github.html"><a href="github.html#project-oriented-workflows-in-action-aka-our-analytical-setup"><i class="fa fa-check"></i><b>4.8</b> Project-oriented workflows in action (aka our analytical setup)</a><ul>
<li class="chapter" data-level="4.8.1" data-path="github.html"><a href="github.html#create-a-new-rmd-file"><i class="fa fa-check"></i><b>4.8.1</b> Create a new Rmd file</a></li>
<li class="chapter" data-level="4.8.2" data-path="github.html"><a href="github.html#create-data-and-figures-folders"><i class="fa fa-check"></i><b>4.8.2</b> Create data and figures folders</a></li>
<li class="chapter" data-level="4.8.3" data-path="github.html"><a href="github.html#move-data-files-to-data-folder"><i class="fa fa-check"></i><b>4.8.3</b> Move data files to data folder</a></li>
<li class="chapter" data-level="4.8.4" data-path="github.html"><a href="github.html#activity-1"><i class="fa fa-check"></i><b>4.8.4</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="github.html"><a href="github.html#committing---how-often-tracking-changes-in-your-files"><i class="fa fa-check"></i><b>4.9</b> Committing - how often? Tracking changes in your files</a></li>
<li class="chapter" data-level="4.10" data-path="github.html"><a href="github.html#issues"><i class="fa fa-check"></i><b>4.10</b> Issues</a><ul>
<li class="chapter" data-level="4.10.1" data-path="github.html"><a href="github.html#issues-in-the-wild"><i class="fa fa-check"></i><b>4.10.1</b> Issues in the wild!</a></li>
<li class="chapter" data-level="4.10.2" data-path="github.html"><a href="github.html#end-github-session"><i class="fa fa-check"></i><b>4.10.2</b> END <strong>GitHub</strong> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2.html"><a href="ggplot2.html"><i class="fa fa-check"></i><b>5</b> Graphs with ggplot2</a><ul>
<li class="chapter" data-level="5.1" data-path="ggplot2.html"><a href="ggplot2.html#summary-2"><i class="fa fa-check"></i><b>5.1</b> Summary</a><ul>
<li class="chapter" data-level="5.1.1" data-path="ggplot2.html"><a href="ggplot2.html#objectives-2"><i class="fa fa-check"></i><b>5.1.1</b> Objectives</a></li>
<li class="chapter" data-level="5.1.2" data-path="ggplot2.html"><a href="ggplot2.html#resources-2"><i class="fa fa-check"></i><b>5.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="ggplot2.html"><a href="ggplot2.html#getting-started---in-existing-.rmd-attach-packages"><i class="fa fa-check"></i><b>5.2</b> Getting started - In existing .Rmd, attach packages</a></li>
<li class="chapter" data-level="5.3" data-path="ggplot2.html"><a href="ggplot2.html#read-in-.xlsx-and-.csv-files"><i class="fa fa-check"></i><b>5.3</b> Read in .xlsx and .csv files</a><ul>
<li class="chapter" data-level="5.3.1" data-path="ggplot2.html"><a href="ggplot2.html#read_csv-to-read-in-comma-separated-value-.csv-files"><i class="fa fa-check"></i><b>5.3.1</b> <code>read_csv()</code> to read in comma-separated-value (.csv) files</a></li>
<li class="chapter" data-level="5.3.2" data-path="ggplot2.html"><a href="ggplot2.html#readxl-to-read-in-excel-files"><i class="fa fa-check"></i><b>5.3.2</b> <code>readxl</code> to read in Excel files</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ggplot2.html"><a href="ggplot2.html#our-first-ggplot-graph-visitors-to-channel-islands-np"><i class="fa fa-check"></i><b>5.4</b> Our first ggplot graph: Visitors to Channel Islands NP</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot2.html"><a href="ggplot2.html#intro-to-customizing-ggplot-graphs"><i class="fa fa-check"></i><b>5.5</b> Intro to customizing <code>ggplot</code> graphs</a><ul>
<li class="chapter" data-level="5.5.1" data-path="ggplot2.html"><a href="ggplot2.html#activity-customize-your-own-ggplot-graph"><i class="fa fa-check"></i><b>5.5.1</b> Activity: customize your own ggplot graph</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="ggplot2.html"><a href="ggplot2.html#mapping-variables-onto-aesthetics"><i class="fa fa-check"></i><b>5.6</b> Mapping variables onto aesthetics</a><ul>
<li class="chapter" data-level="5.6.1" data-path="ggplot2.html"><a href="ggplot2.html#activity-map-variables-onto-graph-aesthetics"><i class="fa fa-check"></i><b>5.6.1</b> Activity: map variables onto graph aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ggplot2.html"><a href="ggplot2.html#ggplot2-complete-themes"><i class="fa fa-check"></i><b>5.7</b> ggplot2 complete themes</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot2.html"><a href="ggplot2.html#updating-axis-labels-and-titles"><i class="fa fa-check"></i><b>5.8</b> Updating axis labels and titles</a></li>
<li class="chapter" data-level="5.9" data-path="ggplot2.html"><a href="ggplot2.html#combining-compatible-geoms"><i class="fa fa-check"></i><b>5.9</b> Combining compatible geoms</a></li>
<li class="chapter" data-level="5.10" data-path="ggplot2.html"><a href="ggplot2.html#multi-series-ggplot-graphs"><i class="fa fa-check"></i><b>5.10</b> Multi-series ggplot graphs</a></li>
<li class="chapter" data-level="5.11" data-path="ggplot2.html"><a href="ggplot2.html#faceting-ggplot-graphs"><i class="fa fa-check"></i><b>5.11</b> Faceting ggplot graphs</a></li>
<li class="chapter" data-level="5.12" data-path="ggplot2.html"><a href="ggplot2.html#exporting-a-ggplot-graph-with-ggsave"><i class="fa fa-check"></i><b>5.12</b> Exporting a ggplot graph with <code>ggsave()</code></a><ul>
<li class="chapter" data-level="5.12.1" data-path="ggplot2.html"><a href="ggplot2.html#end-ggplot-session"><i class="fa fa-check"></i><b>5.12.1</b> End <code>ggplot</code> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pivot.html"><a href="pivot.html"><i class="fa fa-check"></i><b>6</b> Pivot Tables with <code>dplyr</code></a><ul>
<li class="chapter" data-level="6.1" data-path="pivot.html"><a href="pivot.html#summary-3"><i class="fa fa-check"></i><b>6.1</b> Summary</a><ul>
<li class="chapter" data-level="6.1.1" data-path="pivot.html"><a href="pivot.html#objectives-3"><i class="fa fa-check"></i><b>6.1.1</b> Objectives</a></li>
<li class="chapter" data-level="6.1.2" data-path="pivot.html"><a href="pivot.html#resources-3"><i class="fa fa-check"></i><b>6.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pivot.html"><a href="pivot.html#overview-setup"><i class="fa fa-check"></i><b>6.2</b> Overview &amp; setup</a><ul>
<li class="chapter" data-level="6.2.1" data-path="pivot.html"><a href="pivot.html#view-data-in-excel"><i class="fa fa-check"></i><b>6.2.1</b> View data in Excel</a></li>
<li class="chapter" data-level="6.2.2" data-path="pivot.html"><a href="pivot.html#rmarkdown-setup"><i class="fa fa-check"></i><b>6.2.2</b> RMarkdown setup</a></li>
<li class="chapter" data-level="6.2.3" data-path="pivot.html"><a href="pivot.html#our-task"><i class="fa fa-check"></i><b>6.2.3</b> Our task</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="pivot.html"><a href="pivot.html#pivot-table-demo"><i class="fa fa-check"></i><b>6.3</b> Pivot table demo</a><ul>
<li class="chapter" data-level="6.3.1" data-path="pivot.html"><a href="pivot.html#pivot-one-variable"><i class="fa fa-check"></i><b>6.3.1</b> pivot one variable</a></li>
<li class="chapter" data-level="6.3.2" data-path="pivot.html"><a href="pivot.html#pivot-two-variables"><i class="fa fa-check"></i><b>6.3.2</b> pivot two variables</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="pivot.html"><a href="pivot.html#group_by-summarize"><i class="fa fa-check"></i><b>6.4</b> <code>group_by()</code> %&gt;% <code>summarize()</code></a><ul>
<li class="chapter" data-level="6.4.1" data-path="pivot.html"><a href="pivot.html#group_by-one-variable"><i class="fa fa-check"></i><b>6.4.1</b> <code>group_by</code> one variable</a></li>
<li class="chapter" data-level="6.4.2" data-path="pivot.html"><a href="pivot.html#group_by-multiple-variables"><i class="fa fa-check"></i><b>6.4.2</b> <code>group_by</code> multiple variables</a></li>
<li class="chapter" data-level="6.4.3" data-path="pivot.html"><a href="pivot.html#summarize-multiple-variables"><i class="fa fa-check"></i><b>6.4.3</b> <code>summarize</code> multiple variables</a></li>
<li class="chapter" data-level="6.4.4" data-path="pivot.html"><a href="pivot.html#table-formatting-with-kable"><i class="fa fa-check"></i><b>6.4.4</b> Table formatting with <code>kable()</code></a></li>
<li class="chapter" data-level="6.4.5" data-path="pivot.html"><a href="pivot.html#r-code-in-line-in-rmarkdown"><i class="fa fa-check"></i><b>6.4.5</b> R code in-line in RMarkdown</a></li>
<li class="chapter" data-level="6.4.6" data-path="pivot.html"><a href="pivot.html#activity-2"><i class="fa fa-check"></i><b>6.4.6</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="pivot.html"><a href="pivot.html#oh-no-they-sent-the-wrong-data"><i class="fa fa-check"></i><b>6.5</b> Oh no, they sent the wrong data!</a><ul>
<li class="chapter" data-level="6.5.1" data-path="pivot.html"><a href="pivot.html#knit-push-show-differences-on-github"><i class="fa fa-check"></i><b>6.5.1</b> Knit, push, &amp; show differences on GitHub</a></li>
<li class="chapter" data-level="6.5.2" data-path="pivot.html"><a href="pivot.html#dplyrcount"><i class="fa fa-check"></i><b>6.5.2</b> <code>dplyr::count()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="pivot.html"><a href="pivot.html#mutate"><i class="fa fa-check"></i><b>6.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="6.7" data-path="pivot.html"><a href="pivot.html#select"><i class="fa fa-check"></i><b>6.7</b> <code>select()</code></a><ul>
<li class="chapter" data-level="6.7.1" data-path="pivot.html"><a href="pivot.html#end-dplyr-pivot-tables-session"><i class="fa fa-check"></i><b>6.7.1</b> END <strong>dplyr-pivot-tables</strong> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidying.html"><a href="tidying.html"><i class="fa fa-check"></i><b>7</b> Tidying</a><ul>
<li class="chapter" data-level="7.1" data-path="tidying.html"><a href="tidying.html#summary-4"><i class="fa fa-check"></i><b>7.1</b> Summary</a><ul>
<li class="chapter" data-level="7.1.1" data-path="tidying.html"><a href="tidying.html#tidy-data"><i class="fa fa-check"></i><b>7.1.1</b> Tidy data</a></li>
<li class="chapter" data-level="7.1.2" data-path="tidying.html"><a href="tidying.html#objectives-4"><i class="fa fa-check"></i><b>7.1.2</b> Objectives</a></li>
<li class="chapter" data-level="7.1.3" data-path="tidying.html"><a href="tidying.html#resources-4"><i class="fa fa-check"></i><b>7.1.3</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="tidying.html"><a href="tidying.html#set-up"><i class="fa fa-check"></i><b>7.2</b> Set-up</a><ul>
<li class="chapter" data-level="7.2.1" data-path="tidying.html"><a href="tidying.html#create-a-new-r-markdown-and-attach-packages"><i class="fa fa-check"></i><b>7.2.1</b> Create a new R Markdown and attach packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="tidying.html"><a href="tidying.html#read_excel-to-read-in-data-from-an-excel-worksheet"><i class="fa fa-check"></i><b>7.2.2</b> <code>read_excel()</code> to read in data from an Excel worksheet</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="tidying.html"><a href="tidying.html#tidyrpivot_longer-to-reshape-from-wider-to-longer-format"><i class="fa fa-check"></i><b>7.3</b> <code>tidyr::pivot_longer()</code> to reshape from wider-to-longer format</a></li>
<li class="chapter" data-level="7.4" data-path="tidying.html"><a href="tidying.html#tidyrpivot_wider-to-convert-from-longer-to-wider-format"><i class="fa fa-check"></i><b>7.4</b> <code>tidyr::pivot_wider()</code> to convert from longer-to-wider format</a></li>
<li class="chapter" data-level="7.5" data-path="tidying.html"><a href="tidying.html#janitorclean_names-to-clean-up-column-names"><i class="fa fa-check"></i><b>7.5</b> <code>janitor::clean_names()</code> to clean up column names</a></li>
<li class="chapter" data-level="7.6" data-path="tidying.html"><a href="tidying.html#tidyrunite-and-tidyrseparate-to-combine-or-separate-information-in-columns"><i class="fa fa-check"></i><b>7.6</b> <code>tidyr::unite()</code> and <code>tidyr::separate()</code> to combine or separate information in column(s)</a><ul>
<li class="chapter" data-level="7.6.1" data-path="tidying.html"><a href="tidying.html#tidyrunite-to-merge-information-from-separate-columns"><i class="fa fa-check"></i><b>7.6.1</b> <code>tidyr::unite()</code> to merge information from separate columns</a></li>
<li class="chapter" data-level="7.6.2" data-path="tidying.html"><a href="tidying.html#tidyrseparate-to-separate-information-into-multiple-columns"><i class="fa fa-check"></i><b>7.6.2</b> <code>tidyr::separate()</code> to separate information into multiple columns</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="tidying.html"><a href="tidying.html#stringrstr_replace-to-replace-a-pattern"><i class="fa fa-check"></i><b>7.7</b> <code>stringr::str_replace()</code> to replace a pattern</a><ul>
<li class="chapter" data-level="7.7.1" data-path="tidying.html"><a href="tidying.html#end-tidying-session"><i class="fa fa-check"></i><b>7.7.1</b> END <strong>tidying</strong> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="filters.html"><a href="filters.html"><i class="fa fa-check"></i><b>8</b> Filters and joins</a><ul>
<li class="chapter" data-level="8.1" data-path="filters.html"><a href="filters.html#summary-5"><i class="fa fa-check"></i><b>8.1</b> Summary</a><ul>
<li class="chapter" data-level="8.1.1" data-path="filters.html"><a href="filters.html#objectives-5"><i class="fa fa-check"></i><b>8.1.1</b> Objectives</a></li>
<li class="chapter" data-level="8.1.2" data-path="filters.html"><a href="filters.html#resources-5"><i class="fa fa-check"></i><b>8.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="filters.html"><a href="filters.html#set-up-create-a-new-.rmd-attach-packages-get-data"><i class="fa fa-check"></i><b>8.2</b> Set-up: Create a new .Rmd, attach packages &amp; get data</a></li>
<li class="chapter" data-level="8.3" data-path="filters.html"><a href="filters.html#dplyrfilter-to-conditionally-subset-by-rows"><i class="fa fa-check"></i><b>8.3</b> <code>dplyr::filter()</code> to conditionally subset by rows</a><ul>
<li class="chapter" data-level="8.3.1" data-path="filters.html"><a href="filters.html#filter-rows-by-matching-a-single-character-string"><i class="fa fa-check"></i><b>8.3.1</b> Filter rows by matching a single character string</a></li>
<li class="chapter" data-level="8.3.2" data-path="filters.html"><a href="filters.html#filter-rows-based-on-numeric-conditions"><i class="fa fa-check"></i><b>8.3.2</b> Filter rows based on numeric conditions</a></li>
<li class="chapter" data-level="8.3.3" data-path="filters.html"><a href="filters.html#filter-to-return-rows-that-match-this-or-that-or-that"><i class="fa fa-check"></i><b>8.3.3</b> Filter to return rows that match <em>this</em> OR <em>that</em> OR <em>that</em></a></li>
<li class="chapter" data-level="8.3.4" data-path="filters.html"><a href="filters.html#filter-to-return-observations-that-match-this-and-that"><i class="fa fa-check"></i><b>8.3.4</b> Filter to return observations that match <strong>this</strong> AND <strong>that</strong></a></li>
<li class="chapter" data-level="8.3.5" data-path="filters.html"><a href="filters.html#activity-combined-filter-conditions"><i class="fa fa-check"></i><b>8.3.5</b> Activity: combined filter conditions</a></li>
<li class="chapter" data-level="8.3.6" data-path="filters.html"><a href="filters.html#stringrstr_detect-to-filter-by-a-partial-pattern"><i class="fa fa-check"></i><b>8.3.6</b> <code>stringr::str_detect()</code> to filter by a partial pattern</a></li>
<li class="chapter" data-level="8.3.7" data-path="filters.html"><a href="filters.html#activity-6"><i class="fa fa-check"></i><b>8.3.7</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="filters.html"><a href="filters.html#dplyr_join-to-merge-data-frames"><i class="fa fa-check"></i><b>8.4</b> <code>dplyr::*_join()</code> to merge data frames</a><ul>
<li class="chapter" data-level="8.4.1" data-path="filters.html"><a href="filters.html#full_join-to-merge-data-frames-keeping-everything"><i class="fa fa-check"></i><b>8.4.1</b> <code>full_join()</code> to merge data frames, keeping everything</a></li>
<li class="chapter" data-level="8.4.2" data-path="filters.html"><a href="filters.html#left_joinxy-to-merge-data-frames-keeping-everything-in-the-x-data-frame-and-only-matches-from-the-y-data-frame"><i class="fa fa-check"></i><b>8.4.2</b> <code>left_join(x,y)</code> to merge data frames, keeping everything in the ‘x’ data frame and only matches from the ‘y’ data frame</a></li>
<li class="chapter" data-level="8.4.3" data-path="filters.html"><a href="filters.html#inner_join-to-merge-data-frames-only-keeping-observations-with-a-match-in-both"><i class="fa fa-check"></i><b>8.4.3</b> <code>inner_join()</code> to merge data frames, only keeping observations with a match in <strong>both</strong></a></li>
<li class="chapter" data-level="8.4.4" data-path="filters.html"><a href="filters.html#filter-and-join-in-a-sequence"><i class="fa fa-check"></i><b>8.4.4</b> <code>filter()</code> and <code>join()</code> in a sequence</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="filters.html"><a href="filters.html#an-html-table-with-kable-and-kableextra"><i class="fa fa-check"></i><b>8.5</b> An HTML table with <code>kable()</code> and <code>kableExtra</code></a><ul>
<li class="chapter" data-level="8.5.1" data-path="filters.html"><a href="filters.html#end-filter-_join-section"><i class="fa fa-check"></i><b>8.5.1</b> End <code>filter()</code> + <code>_join()</code> section!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="collaborating.html"><a href="collaborating.html"><i class="fa fa-check"></i><b>9</b> Collaborating &amp; getting help</a><ul>
<li class="chapter" data-level="9.1" data-path="collaborating.html"><a href="collaborating.html#summary-6"><i class="fa fa-check"></i><b>9.1</b> Summary</a><ul>
<li class="chapter" data-level="9.1.1" data-path="collaborating.html"><a href="collaborating.html#objectives-6"><i class="fa fa-check"></i><b>9.1.1</b> Objectives</a></li>
<li class="chapter" data-level="9.1.2" data-path="collaborating.html"><a href="collaborating.html#resources-6"><i class="fa fa-check"></i><b>9.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="collaborating.html"><a href="collaborating.html#r-communities"><i class="fa fa-check"></i><b>9.2</b> R communities</a><ul>
<li class="chapter" data-level="9.2.1" data-path="collaborating.html"><a href="collaborating.html#community-awesomeness"><i class="fa fa-check"></i><b>9.2.1</b> Community awesomeness</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="collaborating.html"><a href="collaborating.html#how-to-use-twitter-for-rstats"><i class="fa fa-check"></i><b>9.3</b> How to use Twitter for #rstats</a><ul>
<li class="chapter" data-level="9.3.1" data-path="collaborating.html"><a href="collaborating.html#examples"><i class="fa fa-check"></i><b>9.3.1</b> Examples</a></li>
<li class="chapter" data-level="9.3.2" data-path="collaborating.html"><a href="collaborating.html#how-to-twitter"><i class="fa fa-check"></i><b>9.3.2</b> How to Twitter</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="collaborating.html"><a href="collaborating.html#getting-help"><i class="fa fa-check"></i><b>9.4</b> Getting help</a><ul>
<li class="chapter" data-level="9.4.1" data-path="collaborating.html"><a href="collaborating.html#read-the-error-message"><i class="fa fa-check"></i><b>9.4.1</b> Read the error message</a></li>
<li class="chapter" data-level="9.4.2" data-path="collaborating.html"><a href="collaborating.html#googling"><i class="fa fa-check"></i><b>9.4.2</b> Googling</a></li>
<li class="chapter" data-level="9.4.3" data-path="collaborating.html"><a href="collaborating.html#create-a-reprex"><i class="fa fa-check"></i><b>9.4.3</b> Create a reprex</a></li>
<li class="chapter" data-level="9.4.4" data-path="collaborating.html"><a href="collaborating.html#activity-7"><i class="fa fa-check"></i><b>9.4.4</b> Activity</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="collaborating.html"><a href="collaborating.html#collaborating-with-github"><i class="fa fa-check"></i><b>9.5</b> Collaborating with GitHub</a><ul>
<li class="chapter" data-level="9.5.1" data-path="collaborating.html"><a href="collaborating.html#create-repo-partner-1"><i class="fa fa-check"></i><b>9.5.1</b> Create repo (Partner 1)</a></li>
<li class="chapter" data-level="9.5.2" data-path="collaborating.html"><a href="collaborating.html#create-a-gh-pages-branch-partner-1"><i class="fa fa-check"></i><b>9.5.2</b> Create a gh-pages branch (Partner 1)</a></li>
<li class="chapter" data-level="9.5.3" data-path="collaborating.html"><a href="collaborating.html#give-your-collaborator-privileges-partner-1-and-2"><i class="fa fa-check"></i><b>9.5.3</b> Give your collaborator privileges (Partner 1 and 2)</a></li>
<li class="chapter" data-level="9.5.4" data-path="collaborating.html"><a href="collaborating.html#clone-to-a-new-r-project-partner-1"><i class="fa fa-check"></i><b>9.5.4</b> Clone to a new R Project (Partner 1)</a></li>
<li class="chapter" data-level="9.5.5" data-path="collaborating.html"><a href="collaborating.html#clone-to-a-new-r-project-partner-2"><i class="fa fa-check"></i><b>9.5.5</b> Clone to a new R Project (Partner 2)</a></li>
<li class="chapter" data-level="9.5.6" data-path="collaborating.html"><a href="collaborating.html#create-data-folder-partner-2"><i class="fa fa-check"></i><b>9.5.6</b> Create data folder (Partner 2)</a></li>
<li class="chapter" data-level="9.5.7" data-path="collaborating.html"><a href="collaborating.html#state-of-the-repository"><i class="fa fa-check"></i><b>9.5.7</b> State of the Repository</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="collaborating.html"><a href="collaborating.html#merge-conflicts"><i class="fa fa-check"></i><b>9.6</b> Merge conflicts</a><ul>
<li class="chapter" data-level="9.6.1" data-path="collaborating.html"><a href="collaborating.html#pull-partners-1-and-2"><i class="fa fa-check"></i><b>9.6.1</b> Pull (Partners 1 and 2)</a></li>
<li class="chapter" data-level="9.6.2" data-path="collaborating.html"><a href="collaborating.html#create-a-conflict-partners-1-and-2"><i class="fa fa-check"></i><b>9.6.2</b> Create a conflict (Partners 1 and 2)</a></li>
<li class="chapter" data-level="9.6.3" data-path="collaborating.html"><a href="collaborating.html#sync-partner-2"><i class="fa fa-check"></i><b>9.6.3</b> Sync (Partner 2)</a></li>
<li class="chapter" data-level="9.6.4" data-path="collaborating.html"><a href="collaborating.html#sync-attempts-fixes-partner-1"><i class="fa fa-check"></i><b>9.6.4</b> Sync attempts &amp; fixes (Partner 1)</a></li>
<li class="chapter" data-level="9.6.5" data-path="collaborating.html"><a href="collaborating.html#activity-8"><i class="fa fa-check"></i><b>9.6.5</b> Activity</a></li>
<li class="chapter" data-level="9.6.6" data-path="collaborating.html"><a href="collaborating.html#how-do-you-avoid-merge-conflicts"><i class="fa fa-check"></i><b>9.6.6</b> How do you avoid merge conflicts?</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="collaborating.html"><a href="collaborating.html#create-your-collaborative-website"><i class="fa fa-check"></i><b>9.7</b> Create your collaborative website</a><ul>
<li class="chapter" data-level="9.7.1" data-path="collaborating.html"><a href="collaborating.html#end-collaborating-session"><i class="fa fa-check"></i><b>9.7.1</b> END <strong>collaborating</strong> session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="synthesis.html"><a href="synthesis.html"><i class="fa fa-check"></i><b>10</b> Synthesis</a><ul>
<li class="chapter" data-level="10.1" data-path="synthesis.html"><a href="synthesis.html#summary-7"><i class="fa fa-check"></i><b>10.1</b> Summary</a><ul>
<li class="chapter" data-level="10.1.1" data-path="synthesis.html"><a href="synthesis.html#objectives-7"><i class="fa fa-check"></i><b>10.1.1</b> Objectives</a></li>
<li class="chapter" data-level="10.1.2" data-path="synthesis.html"><a href="synthesis.html#resources-7"><i class="fa fa-check"></i><b>10.1.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="synthesis.html"><a href="synthesis.html#attach-packages-read-in-and-explore-the-data"><i class="fa fa-check"></i><b>10.2</b> Attach packages, read in and explore the data</a></li>
<li class="chapter" data-level="10.3" data-path="synthesis.html"><a href="synthesis.html#some-data-cleaning-to-get-salmon-landings-by-species"><i class="fa fa-check"></i><b>10.3</b> Some data cleaning to get salmon landings by species</a></li>
<li class="chapter" data-level="10.4" data-path="synthesis.html"><a href="synthesis.html#find-total-annual-us-value-for-each-salmon-subgroup"><i class="fa fa-check"></i><b>10.4</b> Find total annual US value ($) for each salmon subgroup</a></li>
<li class="chapter" data-level="10.5" data-path="synthesis.html"><a href="synthesis.html#make-a-graph-of-us-commercial-fisheries-value-by-species-over-time-with-ggplot2"><i class="fa fa-check"></i><b>10.5</b> Make a graph of US commercial fisheries value by species over time with <code>ggplot2</code></a></li>
<li class="chapter" data-level="10.6" data-path="synthesis.html"><a href="synthesis.html#built-in-color-palettes"><i class="fa fa-check"></i><b>10.6</b> Built-in color palettes</a></li>
<li class="chapter" data-level="10.7" data-path="synthesis.html"><a href="synthesis.html#sync-with-github-remote"><i class="fa fa-check"></i><b>10.7</b> Sync with GitHub remote</a></li>
<li class="chapter" data-level="10.8" data-path="synthesis.html"><a href="synthesis.html#add-an-image-to-your-partners-document"><i class="fa fa-check"></i><b>10.8</b> Add an image to your partner’s document</a><ul>
<li class="chapter" data-level="10.8.1" data-path="synthesis.html"><a href="synthesis.html#end-synthesis-session"><i class="fa fa-check"></i><b>10.8.1</b> End Synthesis session!</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="closing.html"><a href="closing.html"><i class="fa fa-check"></i><b>11</b> Closing</a><ul>
<li class="chapter" data-level="11.1" data-path="closing.html"><a href="closing.html#continued-learning"><i class="fa fa-check"></i><b>11.1</b> Continued learning</a><ul>
<li class="chapter" data-level="11.1.1" data-path="closing.html"><a href="closing.html#communities-to-join"><i class="fa fa-check"></i><b>11.1.1</b> Communities to join</a></li>
<li class="chapter" data-level="11.1.2" data-path="closing.html"><a href="closing.html#resources-8"><i class="fa fa-check"></i><b>11.1.2</b> Resources</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Excel Users</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pivot" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Pivot Tables with <code>dplyr</code></h1>
<!---
Why would you ever want to uncount? You don’t want to assume how future you will want to use this data
How easy is it to get these counts by different groupings
--->
<div id="summary-3" class="section level2">
<h2><span class="header-section-number">6.1</span> Summary</h2>
<p>Pivot tables are powerful tools in Excel for summarizing data in different ways. We will create these tables using the <code>group_by</code> and <code>summarize</code> functions from the <code>dplyr</code> package (part of the Tidyverse). We will also learn how to format tables and practice creating a reproducible report using RMarkdown and sharing it with GitHub.</p>
<p><strong>Data used in the synthesis section:</strong></p>
<ul>
<li>File name: lobsters.xlsx and lobsters2.xlsx<br />
</li>
<li>Description: Lobster size, abundance and fishing pressure (Santa Barbara coast)<br />
</li>
<li>Link: <a href="https://portal.edirepository.org/nis/mapbrowse?scope=knb-lter-sbc&amp;identifier=77&amp;revision=newest" class="uri">https://portal.edirepository.org/nis/mapbrowse?scope=knb-lter-sbc&amp;identifier=77&amp;revision=newest</a><br />
</li>
<li>Citation: Reed D. 2019. SBC LTER: Reef: Abundance, size and fishing effort for California Spiny Lobster (Panulirus interruptus), ongoing since 2012. Environmental Data Initiative. <a href="https://doi.org/10.6073/pasta/a593a675d644fdefb736750b291579a0">doi</a>.</li>
</ul>
<div id="objectives-3" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Objectives</h3>
<p>In R, we can use the <code>dplyr</code> package for pivot tables by using 2 functions <code>group_by</code> and <code>summarize</code> together with the pipe operator <code>%&gt;%</code>. We will also continue to emphasize reproducibility in all our analyses.</p>
<ul>
<li>Discuss pivot tables in Excel</li>
<li>Introduce <code>group_by() %&gt;% summarize()</code> from the <code>dplyr</code> package</li>
<li>Learn <code>mutate()</code> and <code>select()</code> to work column-wise</li>
<li>Practice our reproducible workflow with RMarkdown and GitHub</li>
</ul>
</div>
<div id="resources-3" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Resources</h3>
<ul>
<li><a href="https://dplyr.tidyverse.org/"><code>dplyr</code> website: dplyr.tidyverse.org</a></li>
<li><a href="https://r4ds.had.co.nz/transform.html">R for Data Science: Transform Chapter</a> by Hadley Wickham &amp; Garrett Grolemund</li>
<li><a href="https://youtu.be/g530cnFfk8Y">Intro to Pivot Tables I-III videos</a> by Excel Campus</li>
<li><a href="https://peerj.com/preprints/3183/">Data organization in spreadsheets</a> by Karl Broman &amp; Kara Woo</li>
</ul>
</div>
</div>
<div id="overview-setup" class="section level2">
<h2><span class="header-section-number">6.2</span> Overview &amp; setup</h2>
<p><a href="https://en.wikipedia.org/wiki/Pivot_table">Wikipedia describes a pivot table</a> as a “table of statistics that summarizes the data of a more extensive table…this summary might include sums, averages, or other statistics, which the pivot table groups together in a meaningful way.”</p>
<blockquote>
<p><strong>Aside:</strong> Wikipedia also says that “Although pivot table is a generic term, Microsoft trademarked PivotTable in the United States in 1994.”</p>
</blockquote>
<p>Pivot tables are a really powerful tool for summarizing data, and we can have similar functionality in R — as well as nicely automating and reporting these tables.</p>
<p>We will first have a look at our data, demo using pivot tables in Excel, and then create reproducible tables in R.</p>
<div id="view-data-in-excel" class="section level3">
<h3><span class="header-section-number">6.2.1</span> View data in Excel</h3>
<p>When reading in Excel files (or really any data that isn’t yours), it can be a good idea to open the data and look at it so you know what you’re up against.</p>
<p>Let’s open the lobsters.xlsx data in Excel.</p>
<p>It’s one sheet, and it’s rectangular. In this data set, every row is a unique observation. This is called “uncounted” data; you’ll see there is no row for how many lobsters were seen because each row is an observation, or an “n of 1”.</p>
<p>But also notice that the data doesn’t start until line 5; there are 4 lines of metadata — data about the data that is super important! — that we don’t want to muddy our analyses.</p>
<p>Now your first idea might be to delete these 4 rows from this Excel sheet and save them on another, but we also know that we need to keep the raw data raw. So let’s not touch this data in Excel, we’ll remove these lines in R. Let’s do that first so then we’ll be all set.</p>
</div>
<div id="rmarkdown-setup" class="section level3">
<h3><span class="header-section-number">6.2.2</span> RMarkdown setup</h3>
<p>Let’s start a new RMarkdown file in our repo, at the top-level (where it will be created by default in our Project). I’ll call mine <code>pivot_lobsters.Rmd</code>.</p>
<p>In the setup chunk, let’s attach our libraries and read in our lobster data. In addition to the <code>tidyverse</code> package we will also use the <code>skimr</code> package. You will have to install it, but don’t want it to be installed every time you write your code. The following is a nice convention for having the install instructions available (on the same line) as the <code>library()</code> call.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="co">## attach libraries</span></a>
<a class="sourceLine" id="cb55-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb55-3" data-line-number="3"><span class="kw">library</span>(readxl)</a>
<a class="sourceLine" id="cb55-4" data-line-number="4"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb55-5" data-line-number="5"><span class="kw">library</span>(skimr) <span class="co"># install.packages(&#39;skimr&#39;)</span></a>
<a class="sourceLine" id="cb55-6" data-line-number="6"><span class="kw">library</span>(kableExtra) <span class="co"># install.packages(&#39;kableExtra&#39;)</span></a></code></pre></div>
<p>We used the <code>read_excel()</code> before, which is the generic function that reads both .xls and .xlsx files. Since we know that this is a .xlsx file, we will demo using the <code>read_xlsx()</code> function.</p>
<p>We can expect that someone in the history of R and especially the history of the <code>readxl</code> package has needed to skip lines at the top of an Excel file before. So let’s look at the help pages <code>?read_xlsx</code>: there is an argument called <code>skip</code> that we can set to 4 to skip 4 lines.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1"><span class="co">## read in data</span></a>
<a class="sourceLine" id="cb56-2" data-line-number="2">lobsters &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="kw">here</span>(<span class="st">&quot;data/lobsters.xlsx&quot;</span>), <span class="dt">skip=</span><span class="dv">4</span>)</a></code></pre></div>
<p>Great. We’ve seen this data in Excel so I don’t feel the need to use <code>head()</code> here like we’ve done before, but I do like having a look at summary statistics and classes.</p>
<div id="skimrskim" class="section level4">
<h4><span class="header-section-number">6.2.2.1</span> <code>skimr::skim</code></h4>
<p>To look at summary statistics we’ve used <code>summary</code>, which is good for numeric columns, but it doesn’t give a lot of useful information for non-numeric data. So it means it wouldn’t tell us how many unique sites there are in this dataset. To have a look there I like using the <code>skimr</code> package:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="co"># explore data</span></a>
<a class="sourceLine" id="cb57-2" data-line-number="2">skimr<span class="op">::</span><span class="kw">skim</span>(lobsters) </a></code></pre></div>
<p>This <code>skimr::</code> notation is a reminder to me that <code>skim</code> is from the <code>skimr</code> package. It is a nice convention: it’s a reminder to others (especially you!).</p>
<p><code>skim</code> lets us look more at each variable. Here we can look at our character variables and see that there are 5 unique sites (in the <code>n_unique</code> output). Also, I particularly like looking at missing data. There are 6 missing values in the <code>size_mm</code> variable.</p>
</div>
</div>
<div id="our-task" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Our task</h3>
<p>So now we have an idea of our data. But now we have a task: we’ve been asked by a colleague to report about how the average size of lobsters has changed for each site across time.</p>
<p>We will complete this task with R by using the <code>dplyr</code> package for data wrangling, which we will do after demoing how this would do it with pivot tables in Excel.</p>
</div>
</div>
<div id="pivot-table-demo" class="section level2">
<h2><span class="header-section-number">6.3</span> Pivot table demo</h2>
<p>I will demo how we will make a pivot table with our lobster data. You are welcome to sit back and watch rather than following along.</p>
<p>First let’s summarize how many lobsters were counted each year. This means I want to count of rows by year.</p>
<p>So to do this in Excel we would initiate the Pivot Table Process:</p>
<p><br></p>
<p><img src="img/pivot-table-menu.png" width="60%" /></p>
<p><br></p>
<p>Excel will ask what data I would like to include, and it will do its best to suggest coordinates for my data within the spreadsheet (it can have difficulty with non-rectangular or “non-tidy” data). It does a good job here of ignoring those top lines of data description.</p>
<p>It will also suggest we make our PivotTable in a new worksheet.</p>
<p><br></p>
<p><img src="img/pivot-table-create.png" width="60%" /></p>
<p><br></p>
<p>And then we’ll see our new sheet and a little wizard to help us create the PivotTable.</p>
<div id="pivot-one-variable" class="section level3">
<h3><span class="header-section-number">6.3.1</span> pivot one variable</h3>
<p>I want to start by summarizing by year, so I first drag the <code>year</code> variable down into the “Rows” box. What I see at this point are the years listed: this confirms that I’m going to group by years.</p>
<p><br></p>
<p><img src="img/pivot-table-count-year-groupby.png" width="60%" /></p>
<p><br></p>
<p>And then, to summarize the counts for each year, I actually drag the same <code>year</code> variable into the “Values” box. And it will create a Pivot Table for me! But “sum” as the default summary statistic; this doesn’t make a whole lot of sense for summarizing years. I can click the little “I” icon to change this summary statistic to what I want: Count of year.</p>
<p><br></p>
<p><img src="img/pivot-table-count-year.png" width="60%" /></p>
<p><br></p>
<p>A few things to note:</p>
<ul>
<li>The pivot table is separate entity from our data (it’s on a different sheet); the original data has not been affected. This “keeps the raw data raw”, which is great practice.</li>
<li>The pivot table summarizes on the variables you request meaning that we don’t see other columns (like date, month, or site).</li>
<li>Excel also calculates the Grand total for all sites (in bold). This is nice for communicating about data. But it can be problematic in the future, because it might not be clear that this is a calculation and not data. It could be easy to take a total of this column and introduce errors by doubling the total count.</li>
</ul>
<p>So pivot tables are great because they summarize the data and keep the raw data raw — they even promote good practice because they by default ask you if you’d like to present the data in a new sheet rather than in the same sheet.</p>
</div>
<div id="pivot-two-variables" class="section level3">
<h3><span class="header-section-number">6.3.2</span> pivot two variables</h3>
<p>We can include multiple variables in our PivotTable. If we want to add site as a second variable, we can drag it down:</p>
<p><img src="img/pivot-table-count-year-site.png" width="60%" /></p>
<p>But this is comparing sites within a year; we want to compare years within a site. We can reverse the order easily enough by dragging (you just have to remember to do all of these steps the next time you’d want to repeat this):</p>
<p><img src="img/pivot-table-count-site-year.png" width="60%" /></p>
<p>So in terms of our full task, which is to compare the average lobster size by site and year, we are on our way! I’ll leave this as a cliff-hanger here in Excel and we will carry forward in R.</p>
<p>Just to recap what we did here: we told Excel we wanted to group by something (here: <code>year</code> and <code>site</code>) and then summarize by something (here: count, not sum!)</p>
<!---
All verbs work similarly:

1. The first argument is a data frame.
2. The subsequent arguments describe what to do with the data frame. You can refer to columns in the data frame directly without using `$`.
3. The result is a new data frame.

Together these properties make it easy to chain together multiple simple steps to achieve a complex result using the pipe operator `%>%`.

I love thinking of these `dplyr` verbs and the pipe operator `%>%` as telling a story. When I see `%>%` I think "and then":


```r
data %>%          # start with data, and then
  group_by() %>%  # group by a variable, and then
  mutate() %>%    # mutate to add a new column, and then
  select()        # select specific columns
```


--->
</div>
</div>
<div id="group_by-summarize" class="section level2">
<h2><span class="header-section-number">6.4</span> <code>group_by()</code> %&gt;% <code>summarize()</code></h2>
<p>In R, we can create the functionality of pivot tables with the same logic: we will tell R to group by something and then summarize by something. Visually, it looks like this:</p>
<p><br>
<img src="img/rstudio-cheatsheet-group_by_summarize.png" width="80%" />
<br></p>
<p>This graphic is from <a href="http://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf">RStudio’s old-school data wrangling cheatsheet</a>; all cheatsheets available from <a href="https://rstudio.com/resources/cheatsheets" class="uri">https://rstudio.com/resources/cheatsheets</a>). It’s incredibly powerful to visualize what we are talking about with our data when do do these kinds of operations.</p>
<p>And in code, it looks like this:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1">data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb58-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb58-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>()</a></code></pre></div>
<p>It reads: “Take the data and then group by something and then summarize by something”.</p>
<p>The pipe operator <code>%&gt;%</code> is a really critical feature of the <code>dplyr</code> package, originally created for the <code>magrittr</code> package. It lets us chain together steps of our data wrangling, enabling us to tell a clear story about our entire data analysis. This is not only a written story to archive what we’ve done, but it will be a reproducible story that can be rerun and remixed. It is not difficult to read as a human, and it is not a series of clicks to remember.
Let’s try it out!</p>
<div id="group_by-one-variable" class="section level3">
<h3><span class="header-section-number">6.4.1</span> <code>group_by</code> one variable</h3>
<p>Let’s use <code>group_by() %&gt;% summarize()</code> with our <code>lobsters</code> data, just like we did in Excel. We will first group_by year and then summarize by count, using the function <code>n()</code> (in the <code>dplyr</code> package). <code>n()</code> counts the number of times an observation shows up, and since this is uncounted data, this will count each row.</p>
<p>We can say this out loud while we write it: “take the lobsters data and then group_by year and then summarize by count in a new column we’ll call <code>count_by_year</code>”.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_year =</span> <span class="kw">n</span>())</a></code></pre></div>
<p>Notice how together, <code>group_by</code> and <code>summarize</code> minimize the amount of information we see. We also saw this with the pivot table. We lose the other columns that aren’t involved here.</p>
<p>Question: What if you <em>don’t</em> group_by first? Let’s try it and discuss what’s going on.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count =</span>  <span class="kw">n</span>())</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   count
##   &lt;int&gt;
## 1  2893</code></pre>
<p>So if we don’t <code>group_by</code> first, we will get a single summary statistic (sum in this case) for the whole dataset.</p>
<p>Another question: what if we <em>only</em> group_by?</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(year)</a></code></pre></div>
<pre><code>## # A tibble: 2,893 x 7
## # Groups:   year [5]
##     year month date    site  transect replicate size_mm
##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1  2012     8 8/20/12 ivee         3 A              70
##  2  2012     8 8/20/12 ivee         3 B              60
##  3  2012     8 8/20/12 ivee         3 B              65
##  4  2012     8 8/20/12 ivee         3 B              70
##  5  2012     8 8/20/12 ivee         3 B              85
##  6  2012     8 8/20/12 ivee         3 C              60
##  7  2012     8 8/20/12 ivee         3 C              65
##  8  2012     8 8/20/12 ivee         3 C              67
##  9  2012     8 8/20/12 ivee         3 D              70
## 10  2012     8 8/20/12 ivee         4 B              85
## # … with 2,883 more rows</code></pre>
<p>R doesn’t summarize our data, but you can see from the output that it is indeed grouped. However, we haven’t done anything to the original data: we are only exploring. We are keeping the raw data raw.</p>
<p>To convince ourselves, let’s now check the <code>lobsters</code> variable. We can do this by clicking on <code>lobsters</code> in the Environment pane in RStudio.</p>
<p>We see that we haven’t changed any of our original data that was stored in this variable. (Just like how the pivot table didn’t affect the raw data on the original sheet).</p>
<blockquote>
<p><strong><em>Aside</em></strong>: You’ll also see that when you click on the variable name in the Environment pane, <code>View(lobsters)</code> shows up in your Console. <code>View()</code> (capital V) is the R function to view any variable in the viewer. So this is something that you can write in your RMarkdown script, although RMarkdown will not be able to knit this view feature into the formatted document. So, if you want include <code>View()</code> in your RMarkdown document you will need to either comment it out <code>#View()</code> or add <code>eval=FALSE</code> to the top of the code chunk so that the full line reads <code>{r, eval=FALSE}</code>.</p>
</blockquote>
</div>
<div id="group_by-multiple-variables" class="section level3">
<h3><span class="header-section-number">6.4.2</span> <code>group_by</code> multiple variables</h3>
<p>Great. Now let’s summarize by both year and site like we did in the pivot table. We are able to <code>group_by</code> more than one variable. Let’s do this together:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>())</a></code></pre></div>
<p>We put the site first because that is what we want as an end product. But we could easily have put year first. We saw visually what would happen when we did this in the Pivot Table.</p>
<p>Great.</p>
</div>
<div id="summarize-multiple-variables" class="section level3">
<h3><span class="header-section-number">6.4.3</span> <code>summarize</code> multiple variables</h3>
<p>We can summarize multiple variables at a time.</p>
<p>So far we’ve summarized the count of lobster observations. Let’s also calculate the mean and standard deviation. First let’s use the <code>mean()</code> function to calculate the mean. We do this within the same <code>summarize()</code> function, but we can add a new line to make it easier to read. Notice how when you put your curser within the parenthesis and hit return, the indentation will automatically align.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb65-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>(),</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">            <span class="dt">mean_size_mm =</span> <span class="kw">mean</span>(size_mm))</a></code></pre></div>
<blockquote>
<p><strong><em>Aside</em></strong> Command-I will properly indent selected lines.</p>
</blockquote>
<p>Great! But this will actually calculate some of the means as NA because one or more values in that year are NA. So we can pass an argument that says to remove NAs first before calculating the average. Let’s do that, and then also calculate the standard deviation with the <code>sd()</code> function:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb66-4" data-line-number="4">            <span class="dt">mean_size_mm =</span> <span class="kw">mean</span>(size_mm, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb66-5" data-line-number="5">            <span class="dt">sd_size_mm =</span> <span class="kw">sd</span>(size_mm, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a></code></pre></div>
<p>So we can make the equivalent of Excel’s pivot table in R with <code>group_by() %&gt;% summarize()</code>.</p>
<p>Now we are at the point where we actually want to save this summary information as a variable so we can use it in further analyses and formatting.</p>
<p>So let’s add a variable assignment to that first line:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1">siteyear_summary &lt;-<span class="st"> </span>lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb67-4" data-line-number="4">            <span class="dt">mean_size_mm =</span> <span class="kw">mean</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb67-5" data-line-number="5">            <span class="dt">sd_size_mm =</span> <span class="kw">sd</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb67-6" data-line-number="6"></a>
<a class="sourceLine" id="cb67-7" data-line-number="7"><span class="co">## inspect our new variable </span></a>
<a class="sourceLine" id="cb67-8" data-line-number="8">siteyear_summary </a></code></pre></div>
</div>
<div id="table-formatting-with-kable" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Table formatting with <code>kable()</code></h3>
<p>There are several options for formatting tables in RMarkdown; we’ll show one here from the <code>kableExtra</code> package and learn more about it tomorrow.</p>
<p>It works nicely with the pipe operator, so we can build do this from our new object:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="co">## make a table with our new variable</span></a>
<a class="sourceLine" id="cb68-2" data-line-number="2">siteyear_summary <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3"><span class="st">  </span><span class="kw">kable</span>()</a></code></pre></div>
</div>
<div id="r-code-in-line-in-rmarkdown" class="section level3">
<h3><span class="header-section-number">6.4.5</span> R code in-line in RMarkdown</h3>
<p>Before we let you try this on your own, let’s go outside of our code chunk and write in Markdown.</p>
<p>I want to demo something that is a really powerful RMarkdown feature that we can already leverage with what we know in R.</p>
<p>Write this <strong>in Markdown</strong> but replace the # with a backtick (`): “There are #r nrow(lobsters)# total lobsters included in this report.” Let’s knit to see what happens.</p>
<p>I hope you can start to imagine the possibilities. If you wanted to write which year had the most observations, or which site had a decreasing trend, you would be able to.</p>
</div>
<div id="activity-2" class="section level3">
<h3><span class="header-section-number">6.4.6</span> Activity</h3>
<ol style="list-style-type: decimal">
<li>Build from our analysis and calculate the median lobster size for each site year. Your calculation will use the <code>size_mm</code> variable and function to calculate the median (Hint: ?median)</li>
<li>create and ggsave() a plot.</li>
</ol>
<p>Then, save, commit, and push your .Rmd, .html, and .png.</p>
<p>Solution (no peeking):</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1">siteyear_summary &lt;-<span class="st"> </span>lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb69-4" data-line-number="4">            <span class="dt">mean_size_mm =</span> <span class="kw">mean</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb69-5" data-line-number="5">            <span class="dt">sd_size_mm =</span> <span class="kw">sd</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb69-6" data-line-number="6">            <span class="dt">median_size_mm =</span> <span class="kw">median</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb69-7" data-line-number="7"></a>
<a class="sourceLine" id="cb69-8" data-line-number="8"><span class="co">## a ggplot option:</span></a>
<a class="sourceLine" id="cb69-9" data-line-number="9"><span class="kw">ggplot</span>(<span class="dt">data =</span> siteyear_summary, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> median_size_mm, <span class="dt">color =</span> site)) <span class="op">+</span></a>
<a class="sourceLine" id="cb69-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>() </a></code></pre></div>
<p><img src="R-for-Excel-Users_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;lobsters-line.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="co">## another option:</span></a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="kw">ggplot</span>(siteyear_summary, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> median_size_mm)) <span class="op">+</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site)</a></code></pre></div>
<p><img src="R-for-Excel-Users_files/figure-html/unnamed-chunk-82-2.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;lobsters-col.png&quot;</span>))</a></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p>Don’t forget to knit, commit, and push!</p>
<p>Nice work everybody.</p>
</div>
</div>
<div id="oh-no-they-sent-the-wrong-data" class="section level2">
<h2><span class="header-section-number">6.5</span> Oh no, they sent the wrong data!</h2>
<p>Oh no! After all our analyses and everything we’ve done, our colleague just emailed us at 4:30pm on Friday that he sent the wrong data and we need to redo all our analyses with a new .xlsx file: <code>lobsters2.xlsx</code>, not <code>lobsters.xlsx</code>. Aaaaah!</p>
<p>If we were doing this in Excel, this would be a bummer; we’d have to rebuild our pivot table and click through all of our logic again. And then export our figures and save them into our report.</p>
<p>But, since we did it in R, we are much safer. R’s power is not only in analytical power, but in automation and reproducibility.</p>
<p>This means we can go back to the top of our RMarkdown file, and read in this new data file, and then re-knit. We will still need to check that everything outputs correctly, (and that column headers haven’t been renamed), but our first pass will be to update the filename and re-knit:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="co">## read in data</span></a>
<a class="sourceLine" id="cb75-2" data-line-number="2">lobsters &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="kw">here</span>(<span class="st">&quot;data/lobsters2.xlsx&quot;</span>), <span class="dt">skip=</span><span class="dv">4</span>)</a></code></pre></div>
<p>And now we can see that our plot updated as well:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">siteyear_summary &lt;-<span class="st"> </span>lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb76-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">count_by_siteyear =</span>  <span class="kw">n</span>(), </a>
<a class="sourceLine" id="cb76-4" data-line-number="4">            <span class="dt">mean_size_mm =</span> <span class="kw">mean</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb76-5" data-line-number="5">            <span class="dt">sd_size_mm =</span> <span class="kw">sd</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), </a>
<a class="sourceLine" id="cb76-6" data-line-number="6">            <span class="dt">median_size_mm =</span> <span class="kw">median</span>(size_mm, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), )</a>
<a class="sourceLine" id="cb76-7" data-line-number="7"></a>
<a class="sourceLine" id="cb76-8" data-line-number="8">siteyear_summary</a></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="co">## a ggplot option:</span></a>
<a class="sourceLine" id="cb77-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> siteyear_summary, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> median_size_mm, <span class="dt">color =</span> site)) <span class="op">+</span></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>() </a></code></pre></div>
<p><img src="R-for-Excel-Users_files/figure-html/unnamed-chunk-85-1.png" width="672" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;lobsters-line.png&quot;</span>))</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"></a>
<a class="sourceLine" id="cb78-3" data-line-number="3"><span class="co">## another option:</span></a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="kw">ggplot</span>(siteyear_summary, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> median_size_mm)) <span class="op">+</span></a>
<a class="sourceLine" id="cb78-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>site)</a></code></pre></div>
<p><img src="R-for-Excel-Users_files/figure-html/unnamed-chunk-85-2.png" width="672" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="kw">ggsave</span>(<span class="kw">here</span>(<span class="st">&quot;figures&quot;</span>, <span class="st">&quot;lobsters-col.png&quot;</span>))</a></code></pre></div>
<div id="knit-push-show-differences-on-github" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Knit, push, &amp; show differences on GitHub</h3>
<p>So cool.</p>
</div>
<div id="dplyrcount" class="section level3">
<h3><span class="header-section-number">6.5.2</span> <code>dplyr::count()</code></h3>
<p>Now that we’ve spent time with group_by %&gt;% summarize, there is a shortcut if you only want to summarize by count. This is with a function called <code>count()</code>, and it will group_by your selected variable, count, and then also ungroup. It looks like this:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(site, year)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"></a>
<a class="sourceLine" id="cb80-4" data-line-number="4"><span class="co">## This is the same as:</span></a>
<a class="sourceLine" id="cb80-5" data-line-number="5">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(site, year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb80-7" data-line-number="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Hey, we could update our RMarkdown text knowing this: There are #r count(lobsters)# total lobsters included in this summary.</p>
<p>Switching gears…</p>
</div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">6.6</span> <code>mutate()</code></h2>
<p><img src="img/rstudio-cheatsheet-mutate.png" width="80%" /></p>
<p><br></p>
<p>There are a lot of times where you don’t want to summarize your data, but you do want to operate beyond the original data. This is often done by adding a column. We do this with the <code>mutate()</code> function from <code>dplyr</code>. Let’s try this with our original lobsters data. The sizes are in millimeters but let’s say it was important for them to be in meters. We can add a column with this calculation:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" data-line-number="1">lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb81-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">size_m =</span> size_mm <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>)</a></code></pre></div>
<p>If we want to add a column that has the same value repeated, we can pass it just one value, either a number or a character string (in quotes). And let’s save this as a variable called <code>lobsters_detailed</code></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">lobsters_detailed &lt;-<span class="st"> </span>lobsters <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb82-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">size_m =</span> size_mm <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, </a>
<a class="sourceLine" id="cb82-3" data-line-number="3">         <span class="dt">millenia =</span> <span class="dv">2000</span>,</a>
<a class="sourceLine" id="cb82-4" data-line-number="4">         <span class="dt">observer =</span> <span class="st">&quot;Allison Horst&quot;</span>)</a></code></pre></div>
</div>
<div id="select" class="section level2">
<h2><span class="header-section-number">6.7</span> <code>select()</code></h2>
<p>We will end with one final function, <code>select</code>. This is how to choose, retain, and move your data by columns:</p>
<p><img src="img/rstudio-cheatsheet-select.png" width="80%" /></p>
<p><br></p>
<p>Let’s say that we want to present this data finally with only columns for date, site, and size in meters. We would do this:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">lobsters_detailed <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(date, site, size_m)</a></code></pre></div>
<p>One last time, let’s knit, save, commit, and push to GitHub.</p>
<!---

## Deep thoughts

Highly recommended read: [Broman & Woo: Data organization in spreadsheets](https://peerj.com/preprints/3183/). Practical tips to make spreadsheets less error-prone, easier for computers to process, easier to share

Great opening line: "Spreadsheets, for all of their mundane rectangularness, have been the subject of angst and controversy for decades."


## Efficiency Tip

Command - Z to undo  
Command - Shift - Z to redo

Arrow keys to move letter by letter  
Arrow keys - Shift to highlight letter by letter 

Arrow keys - Option to move word by word
Arrow keys - Option to highlight word by word

Arrow keys - Command to move end to end
Arrow keys - Command to highlight end to end

--->
<div id="end-dplyr-pivot-tables-session" class="section level3">
<h3><span class="header-section-number">6.7.1</span> END <strong>dplyr-pivot-tables</strong> session!</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplot2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidying.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R for Excel Users.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
